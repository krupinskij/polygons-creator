!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){var r=n(1),o=n(2);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1},l=(r(o,i),o.locals?o.locals:{});e.exports=l},function(e,t,n){"use strict";var r,o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),l=[];function a(e){for(var t=-1,n=0;n<l.length;n++)if(l[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},r=[],o=0;o<e.length;o++){var i=e[o],c=t.base?i[0]+t.base:i[0],d=n[c]||0,s="".concat(c," ").concat(d);n[c]=d+1;var u=a(s),v={css:i[1],media:i[2],sourceMap:i[3]};-1!==u?(l[u].references++,l[u].updater(v)):l.push({identifier:s,updater:y(v,t),references:1}),r.push(s)}return r}function d(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var l=i(e.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(t)}return t}var s,u=(s=[],function(e,t){return s[e]=t,s.filter(Boolean).join("\n")});function v(e,t,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=u(t,o);else{var i=document.createTextNode(o),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(i,l[t]):e.appendChild(i)}}function x(e,t,n){var r=n.css,o=n.media,i=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,g=0;function y(e,t){var n,r,o;if(t.singleton){var i=g++;n=p||(p=d(t)),r=v.bind(null,n,i,!1),o=v.bind(null,n,i,!0)}else n=d(t),r=x.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var o=a(n[r]);l[o].references--}for(var i=c(e,t),d=0;d<n.length;d++){var s=a(n[d]);0===l[s].references&&(l[s].updater(),l.splice(s,1))}n=i}}}},function(e,t,n){(t=n(3)(!1)).push([e.i,".project-container {\r\n    display: grid;\r\n\r\n    grid-template-columns: auto 1fr 1fr;\r\n    gap: 1%;\r\n\r\n    height: 600px;\r\n    width: 1200px;\r\n\r\n    margin: 1% 2%;\r\n    padding: 1% 2%;\r\n\r\n    border: 1px solid black;\r\n\r\n    align-items: center;\r\n}\r\n\r\n.panel-section {\r\n    margin: 0 10px;\r\n    padding: 10px 10%;\r\n    border: 1px solid black;\r\n\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    height: auto;\r\n}\r\n\r\n.btn {\r\n    padding: 5px 0;\r\n}\r\n\r\n.line {\r\n    display: block;\r\n    border-top: 1px solid #888;\r\n    margin: 2px 0;\r\n}\r\n\r\n/* /// CANVAS PANEL /// */\r\n\r\n.canvas-panel {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\ncanvas {\r\n    border: 1px solid black;\r\n\r\n    cursor: crosshair;\r\n}\r\n\r\n#hidden-canvas {\r\n    display: none;\r\n}\r\n\r\n/* /// POLYGONS PANEL /// */\r\n\r\n.polygons-panel {\r\n    display: grid;\r\n    grid-template-rows: min-content min-content min-content;\r\n    gap: 2%;\r\n}\r\n\r\n/* ADDING SECTION */\r\n\r\n.adding-btn {\r\n    font-size: 100%;\r\n}\r\n\r\n.adding-btn_add {\r\n    font-size: 120%;\r\n}\r\n\r\n/* EDGE EDITION SECTION */\r\n\r\n.edgeEdition-article {\r\n    margin: 2% 0;\r\n    text-align: center;\r\n}\r\n\r\n.thickness-inp {\r\n    width: 20%;\r\n}\r\n\r\n/* JSON SECTION */\r\n\r\n.json-section {\r\n    text-align: center;\r\n    padding-top: 5%;\r\n    padding-bottom: 5%;\r\n}\r\n\r\n.json-section * {\r\n    margin: 1% 0;\r\n}\r\n\r\n.json-section .line {\r\n    margin: 3% 0;\r\n}\r\n\r\n.load-inp {\r\n    width: 100%;;\r\n}\r\n\r\n/* /// EDITION PANEL /// */\r\n\r\n.edition-panel {\r\n    display: grid;\r\n    grid-template-rows: auto min-content min-content;\r\n    gap: 2%;\r\n}\r\n\r\n/* POLYGONS SECTION */\r\n\r\n.polygons-section {\r\n    display: grid;\r\n    grid-template-rows: 1fr auto;\r\n}\r\n\r\n.polygons-container {\r\n    height: 100%;\r\n    overflow-y: scroll;\r\n\r\n    display: flex;\r\n    flex-direction: column;\r\n    height: 100px;\r\n}\r\n\r\n.polygons-btn_polygon {\r\n    font-size: 90%;\r\n\r\n    margin: 0 5%;\r\n}\r\n\r\n.polygons-btn_cancel {\r\n    font-size: 100%;\r\n}\r\n\r\n/* EDITION & RELATION SECTION */\r\n\r\n.edition-btn,\r\n.relation-btn {\r\n    font-size: 90%;\r\n}\r\n\r\n.relation-btn_equal,\r\n.relation-btn_parallel {\r\n    font-size: 80%;\r\n\r\n    margin: 0 5%;\r\n\r\n}\r\n\r\n.relation-btn_equal span {\r\n    display: inline-block;\r\n\r\n    background-color: orange;\r\n\r\n    width: 50%;\r\n}\r\n\r\n.relation-btn_parallel span {\r\n    display: inline-block;\r\n\r\n    background-color: pink;\r\n\r\n    width: 50%;\r\n}",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(l=r,a=btoa(unescape(encodeURIComponent(JSON.stringify(l)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),i=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(i).concat([o]).join("\n")}var l,a,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(o[l]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);r&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";var r,o;n.r(t),n.d(t,"default",(function(){return Q})),function(e){e.Red="rgb(255,0,0)",e.Black="rgb(0,0,0)",e.White="rgb(255,255,255)",e.Orange="orange",e.Pink="pink"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Parallel=1]="Parallel",e[e.Equal=2]="Equal"}(o||(o={}));class i{constructor(e){this.position=e,this.radius=5,this.color=r.Black,this.edgeColor=r.Black,this.prevVertex=null,this.nextVertex=null,this.relation=o.None,this.relationId=null,this.correspondingVertex=null}}function l(e,t,n){Q.context.fillStyle=n,Q.context.beginPath(),Q.context.arc(e.x,e.y,t,0,2*Math.PI,!0),Q.context.fill(),Q.context.fillStyle=r.Black}function a(e,t){Q.context.fillRect(e.x,e.y,t,t)}function c(e,t,n,i){const l=(e.x+t.x)/2,a=(e.y+t.y)/2;n===o.Equal?Q.context.fillStyle=r.Orange:n===o.Parallel?Q.context.fillStyle=r.Pink:Q.context.fillStyle=r.Black,Q.context.fillRect(l+10,a+10,25,25),Q.context.fillStyle=r.Black,Q.context.fillText(String(i),l+15,a+25)}function d(e,t,n){Q.context.fillStyle=n;let r=e.x,o=e.y,i=t.x,l=t.y;if(Math.abs(l-o)<Math.abs(i-r)){if(r>i){let e=r;r=i,i=e;let t=o;o=l,l=t}const e=i-r,t=l-o;let n=2*(t-e);const c=2*t,d=(l-o)*(i-r)>0?2*(t-e):2*(e+t),s=(l-o)*(i-r)>0?1:-1;let u=r,v=o;for(;u<i;){n*s<0?(n+=c,u++):(n+=d,u++,v+=s);for(let e=0;e<Q.thickness;e++)a({x:u,y:Math.ceil(v-Q.thickness/2)+e},1)}}else{if(o>l){let e=r;r=i,i=e;let t=o;o=l,l=t}const e=i-r,t=l-o;let n=2*(e-t);const c=2*e,d=(l-o)*(i-r)>0?2*(e-t):2*(e+t),s=(l-o)*(i-r)>0?1:-1;let u=r,v=o;for(;v<l;){n*s<0?(n+=c,v++):(n+=d,v++,u+=s);for(let e=0;e<Q.thickness;e++)a({x:Math.ceil(u-Q.thickness/2)+e,y:v},1)}}}function s(){Q.polygons.forEach(e=>{for(let t=0;t<e.vertices.length;t++)x(e.vertices[t].position,e.vertices[(t+1)%e.vertices.length].position,e.vertices[t].edgeColor),v(e.vertices[t].position,e.vertices[t].radius,e.vertices[t].color)});const e=Q.hContext.getImageData(0,0,Q.hCanvas.width,Q.hCanvas.height),t=new Uint8ClampedArray(Q.canvas.width*Q.canvas.height*4);for(let n=0,r=0;r<e.data.length/4;n+=8,r+=4)n%(4*Q.hCanvas.width)==0&&n/(4*Q.hCanvas.width)%2==1&&(n+=4*Q.hCanvas.width),t[r]=Math.floor((e.data[n]+e.data[n+4]+e.data[n+4*Q.hCanvas.width]+e.data[n+4*Q.hCanvas.width+4])/4),t[r+1]=Math.floor((e.data[n+1]+e.data[n+5]+e.data[n+4*Q.hCanvas.width+1]+e.data[n+4*Q.hCanvas.width+5])/4),t[r+2]=Math.floor((e.data[n+2]+e.data[n+6]+e.data[n+4*Q.hCanvas.width+2]+e.data[n+4*Q.hCanvas.width+6])/4),t[r+3]=255;let n=new ImageData(t,Q.canvas.width,Q.canvas.height);Q.context.putImageData(n,0,0),Q.polygons.forEach(e=>{for(let t=0;t<e.vertices.length;t++)e.vertices[t].relation!==o.None&&c(e.vertices[t].position,e.vertices[(t+1)%e.vertices.length].position,e.vertices[t].relation,e.vertices[t].relation)})}function u(e,t){Q.hContext.fillRect(e.x,e.y,t,t)}function v(e,t,n){Q.hContext.fillStyle=n,Q.hContext.beginPath(),Q.hContext.arc(2*e.x,2*e.y,2*t,0,2*Math.PI,!0),Q.hContext.fill(),Q.hContext.fillStyle=r.Black}function x(e,t,n){Q.hContext.fillStyle=n;let o=2*e.x,i=2*e.y,l=2*t.x,a=2*t.y;if(Math.abs(a-i)<Math.abs(l-o)){if(o>l){let e=o;o=l,l=e;let t=i;i=a,a=t}const e=l-o,t=a-i;let n=2*(t-e);const r=2*t,c=(a-i)*(l-o)>0?2*(t-e):2*(e+t),d=(a-i)*(l-o)>0?1:-1;let s=o,v=i;for(;s<l;){n*d<0?(n+=r,s++):(n+=c,s++,v+=d);for(let e=0;e<Q.thickness;e++)u({x:s,y:v-Q.thickness+2*e},2)}}else{if(i>a){let e=o;o=l,l=e;let t=i;i=a,a=t}const e=l-o,t=a-i;let n=2*(e-t);const r=2*e,c=(a-i)*(l-o)>0?2*(e-t):2*(e+t),d=(a-i)*(l-o)>0?1:-1;let s=o,v=i;for(;v<a;){n*d<0?(n+=r,v++):(n+=c,v++,s+=d);for(let e=0;e<Q.thickness;e++)u({x:s-Q.thickness+2*e,y:v},2)}}Q.hContext.fillStyle=r.Black}document.getElementById("checkbox-antialiasing").addEventListener("change",g);const p=document.getElementById("checkbox-antialiasing");function g(){if(Q.context.clearRect(0,0,Q.canvas.width,Q.canvas.height),p.checked){Q.hContext.clearRect(0,0,Q.hCanvas.width,Q.hCanvas.height);const e=Q.hContext.fillStyle;Q.hContext.fillStyle=r.White,Q.hContext.fillRect(0,0,Q.hCanvas.width,Q.hCanvas.height),Q.hContext.fillStyle=e,s()}else Q.polygons.forEach(e=>{for(let t=0;t<e.vertices.length;t++)d(e.vertices[t].position,e.vertices[(t+1)%e.vertices.length].position,e.vertices[t].edgeColor),l(e.vertices[t].position,e.vertices[t].radius,e.vertices[t].color),null!==e.vertices[t].relationId&&c(e.vertices[t].position,e.vertices[(t+1)%e.vertices.length].position,e.vertices[t].relation,e.vertices[t].relationId)})}class y{constructor(e){this.vertices=[],this.button=e,this.button.addEventListener("mouseover",()=>{this.changeColor(r.Red)}),this.button.addEventListener("mouseleave",()=>{this.changeColor(r.Black)}),this.button.addEventListener("click",()=>{var e,t,n,r,o,i,l,a;Q.currentPolygon=this,null===(e=document.getElementById("button-polygon-cancel"))||void 0===e||e.removeAttribute("disabled"),Q.addButton.setAttribute("disabled","disabled"),Q.clearButton.setAttribute("disabled","disabled"),null===(t=document.getElementById("button-polygon-movePolygon"))||void 0===t||t.removeAttribute("disabled"),null===(n=document.getElementById("button-polygon-moveVertex"))||void 0===n||n.removeAttribute("disabled"),null===(r=document.getElementById("button-polygon-addVertex"))||void 0===r||r.removeAttribute("disabled"),null===(o=document.getElementById("button-polygon-deleteVertex"))||void 0===o||o.removeAttribute("disabled"),null===(i=document.getElementById("button-polygon-moveEdge"))||void 0===i||i.removeAttribute("disabled"),null===(l=document.getElementById("button-polygon-addRelation"))||void 0===l||l.removeAttribute("disabled"),null===(a=document.getElementById("button-polygon-deleteRelation"))||void 0===a||a.removeAttribute("disabled")})}changeColor(e){this.vertices.forEach(t=>{t.color=e,t.edgeColor=e}),g()}}var f,h;!function(e){e[e.Default=0]="Default",e[e.AddingPolygon=1]="AddingPolygon"}(f||(f={}));class b{constructor(e,t){this.x=e,this.y=t}}function V(e){return new b(e.x-Q.canvas.offsetLeft,e.y-Q.canvas.offsetTop)}function m(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function w(e,t,n){const r=n.x-e.x,o=n.y-e.y,i=t.x-e.x,l=t.y-e.y,a=r*l-o*i;return!(Math.abs(a)>500)&&(Math.abs(i)>=Math.abs(l)?i>0?e.x<=n.x&&n.x<=t.x:t.x<=n.x&&n.x<=e.x:l>0?e.y<=n.y&&n.y<=t.y:t.y<=n.y&&n.y<=e.y)}function P(e,t){if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas dodawania relacji!");e.correspondingVertex=t,t.correspondingVertex=e,e.relationId=Q.relationIterator,t.relationId=Q.relationIterator,Q.relationIterator++,E(Q.currentPolygon.vertices.findIndex(t=>t===e))}function E(e){if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas poprawiania relacji!");let t=Q.currentPolygon.vertices[e%Q.currentPolygon.vertices.length],n=t;do{if(n.correspondingVertex!==t){if(n.relation===o.Equal){const e=n.correspondingVertex;if(null===n.nextVertex||null===e.nextVertex)throw new Error("Wystąpił błąd podczas poprawiania relacji!");const t=m(n.position,n.nextVertex.position)/m(e.position,e.nextVertex.position);e.position.x=Math.floor(e.nextVertex.position.x+(e.position.x-e.nextVertex.position.x)*t),e.position.y=Math.floor(e.nextVertex.position.y+(e.position.y-e.nextVertex.position.y)*t)}else if(n.relation===o.Parallel){const e=n.correspondingVertex;if(null===n.nextVertex||null===e.nextVertex)throw new Error("Wystąpił błąd podczas poprawiania relacji!");if(Math.abs(n.position.y-n.nextVertex.position.y)<Math.abs(n.position.x-n.nextVertex.position.x)){let t=(n.position.y-n.nextVertex.position.y)/(n.position.x-n.nextVertex.position.x);Math.abs(t)<.01&&(t=.01),e.position.y=Math.floor(e.nextVertex.position.y-t*(e.nextVertex.position.x-e.position.x))}else{let t=(n.position.x-n.nextVertex.position.x)/(n.position.y-n.nextVertex.position.y);Math.abs(t)<.01&&(t=.01),e.position.x=Math.floor(e.nextVertex.position.x-t*(e.nextVertex.position.y-e.position.y))}}n=n.nextVertex}else n=n.nextVertex}while(n.nextVertex!==t)}!function(e){e[e.None=0]="None",e[e.MovePolygon=1]="MovePolygon",e[e.MoveVertex=2]="MoveVertex",e[e.AddVertex=3]="AddVertex",e[e.DeleteVertex=4]="DeleteVertex",e[e.MoveEdge=5]="MoveEdge",e[e.MakeParallel=6]="MakeParallel",e[e.MakeEqual=7]="MakeEqual",e[e.DeleteRelation=8]="DeleteRelation"}(h||(h={}));const k=document.getElementById("button-polygon-movePolygon"),T=document.getElementById("button-polygon-moveVertex"),M=document.getElementById("button-polygon-addVertex"),B=document.getElementById("button-polygon-deleteVertex"),A=document.getElementById("button-polygon-moveEdge"),I=document.getElementById("button-polygon-addRelation"),C=document.getElementById("button-polygon-deleteRelation"),z=document.getElementById("button-relation-equal"),R=document.getElementById("button-relation-parallel"),D=document.getElementById("button-polygon-cancel"),j={modification:h.MovePolygon,canMovePolygon:!1,mousedownEventHandler:e=>{j.canMovePolygon=!0,Q.prevPoint=V(e)},mousemoveEventHandler:e=>{if(Q.currPoint=V(e),null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas przesuwania wielokąta!");j.canMovePolygon&&(Q.currentPolygon.vertices.forEach(e=>{if(null===Q.currPoint||null===Q.prevPoint)throw new Error("Wystąpił błąd podczas przesuwania wielokąta!");e.position.x+=Q.currPoint.x-Q.prevPoint.x,e.position.y+=Q.currPoint.y-Q.prevPoint.y}),Q.prevPoint=Q.currPoint,g())},mouseupEventHandler:e=>{j.canMovePolygon=!1,Q.prevPoint=Q.currPoint=null}};let L={modification:h.MoveVertex,vertexFounded:!1,canMoveVertex:!1,vertexToMove:null,indexToMove:null,mousedownEventHandler:e=>{if(L.vertexFounded){if(null===L.vertexToMove)throw new Error("Wystąpił błąd podczas przesuwania wierzchołka!");L.vertexToMove.color=r.Red,L.canMoveVertex=!0,Q.prevPoint=V(e),g()}},mousemoveEventHandler:e=>{if(g(),Q.currPoint=V(e),L.vertexFounded=!1,L.vertexToMove&&!L.canMoveVertex&&(L.vertexToMove.color=r.Black),null===Q.currentPolygon)throw new Event("Wystąpił błąd podczas przesuwania wierzchołka!");for(const e of Q.currentPolygon.vertices){if(L.canMoveVertex)break;m(Q.currPoint,e.position)<10&&(e.color=r.Red,L.vertexToMove=e,L.indexToMove=Q.currentPolygon.vertices.findIndex(t=>t===e),L.vertexFounded=!0)}if(L.canMoveVertex){if(null===L.vertexToMove||null===Q.currPoint||null===Q.prevPoint)throw new Error("Wystąpił błąd podczas przesuwania wierzchołka!");L.vertexToMove.position.x+=Q.currPoint.x-Q.prevPoint.x,L.vertexToMove.position.y+=Q.currPoint.y-Q.prevPoint.y,Q.prevPoint=Q.currPoint,g()}E(L.indexToMove)},mouseupEventHandler:e=>{L.canMoveVertex=!1,L.vertexFounded=!1,L.vertexToMove&&(L.vertexToMove.color=r.Black),L.vertexToMove=null,L.indexToMove=null,Q.prevPoint=Q.currPoint=null}},N={modification:h.AddVertex,canAddVertex:!1,vertexToAdd:null,mousemoveEventHandler:e=>{if(Q.currPoint=V(e),N.canAddVertex=!1,N.vertexToAdd&&!N.canAddVertex){if(null===N.vertexToAdd.nextVertex)throw new Error("Wystąpił błąd podczas dodawania wierzchołka!");N.vertexToAdd.color=r.Black,N.vertexToAdd.edgeColor=r.Black,N.vertexToAdd.nextVertex.color=r.Black}if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas dodawania wierzchołka!");for(const e of Q.currentPolygon.vertices){if(null===e.nextVertex)throw new Error("Wystąpił błąd podczas dodawania wierzchołka!");w(e.position,e.nextVertex.position,Q.currPoint)&&(e.color=r.Red,e.edgeColor=r.Red,e.nextVertex.color=r.Red,N.canAddVertex=!0,N.vertexToAdd=e)}g()},mousedownEventHandler:e=>{const t=V(e);if(N.canAddVertex){if(null===Q.currentPolygon||null===N.vertexToAdd)throw new Error("Wystąpił błąd podczas dodawania wierzchołka!");const e=Q.currentPolygon.vertices.findIndex(e=>e===N.vertexToAdd);Q.currentPolygon.vertices.splice(e+1,0,new i(t)),Q.currentPolygon.vertices[e+1].nextVertex=N.vertexToAdd.nextVertex,N.vertexToAdd.nextVertex=Q.currentPolygon.vertices[e+1],Q.currentPolygon.vertices[e+1].prevVertex=N.vertexToAdd,Q.currentPolygon.vertices[e+1].nextVertex.prevVertex=Q.currentPolygon.vertices[e+1],null!==N.vertexToAdd.correspondingVertex&&(N.vertexToAdd.correspondingVertex.relation=o.None,N.vertexToAdd.correspondingVertex.correspondingVertex=null,N.vertexToAdd.correspondingVertex.relationId=null),N.vertexToAdd.relation=o.None,N.vertexToAdd.correspondingVertex=null,N.vertexToAdd.relationId=null}},mouseupEventHandler:e=>{if(null===N.vertexToAdd||null===N.vertexToAdd.nextVertex||null===N.vertexToAdd.nextVertex.nextVertex)throw new Error("Wystąpił błąd podczas dodawania wierzchołka!");N.canAddVertex=!1,N.vertexToAdd.color=r.Black,N.vertexToAdd.edgeColor=r.Black,N.vertexToAdd.nextVertex.edgeColor=r.Black,N.vertexToAdd.nextVertex.nextVertex.color=r.Black,N.vertexToAdd=null,Q.prevPoint=Q.currPoint=null,g()}},W={modification:h.DeleteVertex,vertexToDelete:null,canDeleteVertex:!1,mousemoveEventHandler:e=>{if(g(),Q.currPoint=V(e),W.canDeleteVertex=!1,null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas usuwania wierzchołka!");for(const e of Q.currentPolygon.vertices)m(e.position,Q.currPoint)<10&&(l(e.position,10,r.Red),W.vertexToDelete=e,W.canDeleteVertex=!0)},mousedownEventHandler:e=>{if(W.canDeleteVertex){if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas usuwania wierzchołka!");if(Q.currentPolygon.vertices.length>3){const e=Q.currentPolygon.vertices.findIndex(e=>e===W.vertexToDelete),t=W.vertexToDelete;if(null===t||null===t.prevVertex||null===t.nextVertex)throw new Error("Wystąpił błąd podczas usuwania wierzchołka!");t.prevVertex.nextVertex=t.nextVertex,t.nextVertex.prevVertex=t.prevVertex,null!==t.correspondingVertex&&(t.correspondingVertex.relation=o.None,t.correspondingVertex.correspondingVertex=null,t.correspondingVertex.relationId=null),t.relation=o.None,t.correspondingVertex=null,t.relationId=null,null!==t.prevVertex.correspondingVertex&&(t.prevVertex.correspondingVertex.relation=o.None,t.prevVertex.correspondingVertex.correspondingVertex=null,t.prevVertex.correspondingVertex.relationId=null),t.prevVertex.relation=o.None,t.prevVertex.correspondingVertex=null,t.prevVertex.relationId=null,Q.currentPolygon.vertices.splice(e,1)}}},mouseupEventHandler:e=>{W.canDeleteVertex=!1,W.vertexToDelete=null,Q.prevPoint=Q.currPoint=null,g()}},S={modification:h.MoveEdge,edgeFounded:!1,canMoveEdge:!1,edgeToMove:[],mousemoveEventHandler:e=>{if(g(),Q.currPoint=V(e),S.edgeFounded=!1,2!==S.edgeToMove.length||S.canMoveEdge||(S.edgeToMove[0].color=r.Black,S.edgeToMove[0].edgeColor=r.Black,S.edgeToMove[1].color=r.Black),null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas przesuwania krawędzi!");for(const e of Q.currentPolygon.vertices){if(S.canMoveEdge)break;if(null===e.nextVertex)throw new Error("Wystąpił błąd podczas przesuwania krawędzi!");w(e.position,e.nextVertex.position,Q.currPoint)&&(e.color=r.Red,e.edgeColor=r.Red,e.nextVertex.color=r.Red,S.edgeToMove=[e,e.nextVertex],S.edgeFounded=!0)}S.canMoveEdge&&(S.edgeToMove.forEach(e=>{if(null===Q.currPoint||null===Q.prevPoint)throw new Error("Wystąpił błąd podczas przesuwania krawędzi!");e.position.x+=Q.currPoint.x-Q.prevPoint.x,e.position.y+=Q.currPoint.y-Q.prevPoint.y}),Q.prevPoint=Q.currPoint,E(Q.currentPolygon.vertices.findIndex(e=>e===S.edgeToMove[0])),g())},mousedownEventHandler:e=>{2===S.edgeToMove.length&&(S.edgeToMove[0].color=r.Red,S.edgeToMove[0].edgeColor=r.Red,S.edgeToMove[1].color=r.Red,S.canMoveEdge=!0,Q.prevPoint=V(e),g())},mouseupEventHandler:e=>{S.canMoveEdge=!1,S.edgeFounded=!1,2===S.edgeToMove.length&&(S.edgeToMove[0].color=r.Black,S.edgeToMove[0].edgeColor=r.Black,S.edgeToMove[1].color=r.Black),S.edgeToMove=[],Q.prevPoint=Q.currPoint=null,g()}};const H={modification:h.MakeParallel,relationVertices:[],relationVertex:null,canAddRelation:!1,mousemoveEventHandler:e=>{if(Q.currPoint=V(e),H.canAddRelation=!1,null!==H.relationVertex&&H.relationVertex!==H.relationVertices[0]&&(H.relationVertices[0]&&H.relationVertex===H.relationVertices[0].nextVertex||(H.relationVertex.color=r.Black),H.relationVertex.edgeColor=r.Black,!H.relationVertices[0]||H.relationVertex.nextVertex!==H.relationVertices[0])){if(null===H.relationVertex.nextVertex)throw new Error("Wystąpił błąd podczas dodawania relacji!");H.relationVertex.nextVertex.color=r.Black}if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas dodawania relacji!");for(const e of Q.currentPolygon.vertices){if(null===e.nextVertex)throw new Error("Wystąpił błąd podczas dodawania relacji!");if(w(e.position,e.nextVertex.position,Q.currPoint)){if(e.relation)break;e.color=r.Red,e.edgeColor=r.Red,e.nextVertex.color=r.Red,H.relationVertex=e,H.canAddRelation=!0}}g()},mousedownEventHandler:e=>{if(H.canAddRelation){if(null===H.relationVertex)throw new Error("Wystąpił błąd podczas dodawania relacji!");if(H.relationVertices.push(H.relationVertex),H.relationVertex.relation=o.Parallel,2===H.relationVertices.length){if(null===H.relationVertices[0].nextVertex||null===H.relationVertices[1].nextVertex)throw new Error("Wystąpił błąd podczas dodawania relacji!");P(H.relationVertices[0],H.relationVertices[1]),H.relationVertices[0].color=r.Black,H.relationVertices[0].edgeColor=r.Black,H.relationVertices[0].nextVertex.color=r.Black,H.relationVertices[1].color=r.Black,H.relationVertices[1].edgeColor=r.Black,H.relationVertices[1].nextVertex.color=r.Black,H.relationVertex=null,H.relationVertices=[]}g()}},mouseupEventHandler:e=>{H.canAddRelation=!1}},O={modification:h.MakeParallel,relationVertices:[],relationVertex:null,canAddRelation:!1,mousemoveEventHandler:e=>{if(Q.currPoint=V(e),H.canAddRelation=!1,null!==H.relationVertex&&H.relationVertex!==H.relationVertices[0]&&(H.relationVertices[0]&&H.relationVertex===H.relationVertices[0].nextVertex||(H.relationVertex.color=r.Black),H.relationVertex.edgeColor=r.Black,!H.relationVertices[0]||H.relationVertex.nextVertex!==H.relationVertices[0])){if(null===H.relationVertex.nextVertex)throw new Error("Wystąpił błąd podczas dodawania relacji!");H.relationVertex.nextVertex.color=r.Black}if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas dodawania relacji!");for(const e of Q.currentPolygon.vertices){if(null===e.nextVertex)throw new Error("Wystąpił błąd podczas dodawania relacji!");if(w(e.position,e.nextVertex.position,Q.currPoint)){if(e.relation)break;e.color=r.Red,e.edgeColor=r.Red,e.nextVertex.color=r.Red,H.relationVertex=e,H.canAddRelation=!0}}g()},mousedownEventHandler:e=>{if(H.canAddRelation){if(null===H.relationVertex)throw new Error("Wystąpił błąd podczas dodawania relacji!");if(H.relationVertices.push(H.relationVertex),H.relationVertex.relation=o.Equal,2===H.relationVertices.length){if(null===H.relationVertices[0].nextVertex||null===H.relationVertices[1].nextVertex)throw new Error("Wystąpił błąd podczas dodawania relacji!");P(H.relationVertices[0],H.relationVertices[1]),H.relationVertices[0].color=r.Black,H.relationVertices[0].edgeColor=r.Black,H.relationVertices[0].nextVertex.color=r.Black,H.relationVertices[1].color=r.Black,H.relationVertices[1].edgeColor=r.Black,H.relationVertices[1].nextVertex.color=r.Black,H.relationVertex=null,H.relationVertices=[]}g()}},mouseupEventHandler:e=>{H.canAddRelation=!1}};let _={modification:h.DeleteRelation,canDeleteRelation:!1,vertexToDelete:null,mousemoveEventHandler:e=>{if(Q.currPoint=V(e),_.canDeleteRelation=!1,null!==_.vertexToDelete&&!_.canDeleteRelation){if(null===_.vertexToDelete.nextVertex)throw new Error("Wystąpił błąd podczas usuwania relacji!");_.vertexToDelete.color=r.Black,_.vertexToDelete.edgeColor=r.Black,_.vertexToDelete.nextVertex.color=r.Black}if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas usuwania relacji!");for(const e of Q.currentPolygon.vertices){if(null===e.nextVertex)throw new Error("Wystąpił błąd podczas usuwania relacji!");if(w(e.position,e.nextVertex.position,Q.currPoint)){if(e.relation===o.None)continue;e.color=r.Red,e.edgeColor=r.Red,e.nextVertex.color=r.Red,_.canDeleteRelation=!0,_.vertexToDelete=e}}g()},mousedownEventHandler:e=>{if(_.canDeleteRelation){if(null===_.vertexToDelete||null===_.vertexToDelete.correspondingVertex)throw new Error("Wystąpił błąd podczas usuwania relacji!");_.vertexToDelete.correspondingVertex.relation=o.None,_.vertexToDelete.correspondingVertex.relationId=null,_.vertexToDelete.correspondingVertex.correspondingVertex=null,_.vertexToDelete.relation=o.None,_.vertexToDelete.relationId=null,_.vertexToDelete.correspondingVertex=null}},mouseupEventHandler:e=>{if(null===_.vertexToDelete||null===_.vertexToDelete.nextVertex)throw new Error("Wystąpił błąd podczas usuwania relacji!");_.canDeleteRelation=!1,_.vertexToDelete.color=r.Black,_.vertexToDelete.edgeColor=r.Black,_.vertexToDelete.nextVertex.color=r.Black,_.vertexToDelete=null,Q.prevPoint=Q.currPoint=null,g()}},q=null;function F(){if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas próby modyfikacji!");null!==q&&U.call(q),q=this,Q.canvas.addEventListener("mousedown",this.mousedownEventHandler),Q.canvas.addEventListener("mousemove",this.mousemoveEventHandler),Q.canvas.addEventListener("mouseup",this.mouseupEventHandler)}function U(){z.setAttribute("disabled","disabled"),R.setAttribute("disabled","disabled"),Q.canvas.removeEventListener("mousedown",this.mousedownEventHandler),Q.canvas.removeEventListener("mousemove",this.mousemoveEventHandler),Q.canvas.removeEventListener("mouseup",this.mouseupEventHandler)}k.addEventListener("click",e=>{F.call(j)}),T.addEventListener("click",e=>{F.call(L)}),M.addEventListener("click",e=>{F.call(N)}),B.addEventListener("click",e=>{F.call(W)}),A.addEventListener("click",e=>{F.call(S)}),R.addEventListener("click",e=>{F.call(H)}),z.addEventListener("click",e=>{F.call(O)}),C.addEventListener("click",e=>{F.call(_)}),I.addEventListener("click",e=>{z.removeAttribute("disabled"),R.removeAttribute("disabled")}),C.addEventListener("click",e=>{z.setAttribute("disabled","disabled"),R.setAttribute("disabled","disabled")}),D.addEventListener("click",e=>{U.call(q),k.setAttribute("disabled","disabled"),T.setAttribute("disabled","disabled"),M.setAttribute("disabled","disabled"),B.setAttribute("disabled","disabled"),A.setAttribute("disabled","disabled"),I.setAttribute("disabled","disabled"),C.setAttribute("disabled","disabled"),z.setAttribute("disabled","disabled"),R.setAttribute("disabled","disabled"),Q.prevPoint=Q.currPoint=null,Q.addButton.removeAttribute("disabled"),Q.clearButton.removeAttribute("disabled"),Q.currentPolygon=null});const G=document.getElementById("file-load"),J=document.getElementById("load-json"),Y=document.getElementById("save-name");document.getElementById("save-json").addEventListener("click",()=>{const e=Q.polygons.map(e=>{const t={points:[],relations:[]},n=new Set;return e.vertices.forEach(r=>{t.points.push({x:r.position.x,y:r.position.y}),r.relation!=o.None&&(n.has(r.relationId)||(n.add(r.relationId),t.relations.push({e1:e.vertices.findIndex(e=>e===r),e2:e.vertices.findIndex(e=>e===r.correspondingVertex),type:r.relation===o.Equal?0:1})))}),t}),t=JSON.stringify(e),n=document.createElement("a");n.href=window.URL.createObjectURL(new Blob([t],{type:"octet/stream"})),n.download=(Y.value.length>0?Y.value:"polygons")+".json",n.click(),Y.value=""}),J.addEventListener("click",()=>{Q.clear();const e=new FileReader;e.addEventListener("load",()=>{var t;t=e.result,JSON.parse(t).forEach(e=>{const t=document.createElement("button");t.innerText="Edytuj wielokąt #1",t.className="polygons-btn_polygon btn",Q.polygonsDiv.appendChild(t);const n=new y(t);e.points.forEach(e=>{n.vertices.push(new i(e))});for(let e=1;e<n.vertices.length;e++)n.vertices[e-1].nextVertex=n.vertices[e],n.vertices[e].prevVertex=n.vertices[e-1],n.vertices[e].edgeColor=r.Black;n.vertices[n.vertices.length-1].nextVertex=n.vertices[0],n.vertices[0].prevVertex=n.vertices[n.vertices.length-1],n.vertices[0].edgeColor=r.Black,e.relations.forEach(e=>{n.vertices[e.e1].relationId=Q.relationIterator,n.vertices[e.e2].relationId=Q.relationIterator,n.vertices[e.e1].correspondingVertex=n.vertices[e.e2],n.vertices[e.e2].correspondingVertex=n.vertices[e.e1],n.vertices[e.e1].relation=0==e.type?o.Equal:o.Parallel,n.vertices[e.e2].relation=0==e.type?o.Equal:o.Parallel,Q.relationIterator++}),Q.polygons.push(n),Q.polygonsInterator++}),g()}),null!==G.files&&G.files[0]&&e.readAsText(G.files[0])});const K=document.getElementById("input-thickness");K.addEventListener("change",()=>{+K.value>10&&(K.value="10"),+K.value<1&&(K.value="1"),Q.thickness=+K.value,g()});n(0);class Q{static init(){Q.addButton.addEventListener("click",()=>{switch(Q.mode){case f.Default:Q.startAdding();break;case f.AddingPolygon:Q.endAdding();break;default:throw new Error("Wystąpił błąd podczas dodawania wielokąta")}}),Q.clearButton.addEventListener("click",Q.clear)}static startAdding(){Q.addButton.innerText="Gotowe",Q.polygonsInterator++;const e=document.createElement("button");e.innerText="Edytuj wielokąt #"+Q.polygonsInterator,e.className="polygons-btn_polygon btn",Q.currentPolygon=new y(e),Q.polygons.push(Q.currentPolygon),Q.canvas.addEventListener("click",Q.addVertex),Q.canvas.addEventListener("mousemove",Q.moveCursor),Q.mode=f.AddingPolygon,Q.addButton.setAttribute("disabled","disabled"),Q.clearButton.setAttribute("disabled","disabled")}static endAdding(){if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas dodawania wielokąta!");Q.addButton.innerText="Dodaj wielokąt",Q.currentPolygon.vertices[Q.currentPolygon.vertices.length-1].edgeColor=r.Black,Q.currentPolygon.vertices[Q.currentPolygon.vertices.length-1].nextVertex=Q.currentPolygon.vertices[0],Q.currentPolygon.vertices[0].prevVertex=Q.currentPolygon.vertices[Q.currentPolygon.vertices.length-1],Q.polygonsDiv.appendChild(Q.currentPolygon.button),Q.canvas.removeEventListener("click",Q.addVertex),Q.canvas.removeEventListener("mousemove",Q.moveCursor),Q.mode=f.Default,Q.currentPolygon=null,Q.prevPoint=Q.currPoint=null,Q.clearButton.removeAttribute("disabled"),g()}static addVertex(e){if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas dodawania wielokąta!");Q.prevPoint=V(e),Q.currentPolygon.vertices.length>2&&m(Q.prevPoint,Q.currentPolygon.vertices[0].position)<=10?Q.endAdding():(Q.currentPolygon.vertices.length>0&&(Q.currentPolygon.vertices[Q.currentPolygon.vertices.length-1].edgeColor=r.Black),Q.currentPolygon.vertices.push(new i(Q.prevPoint)),Q.currentPolygon.vertices.length>1&&(Q.currentPolygon.vertices[Q.currentPolygon.vertices.length-2].nextVertex=Q.currentPolygon.vertices[Q.currentPolygon.vertices.length-1],Q.currentPolygon.vertices[Q.currentPolygon.vertices.length-1].prevVertex=Q.currentPolygon.vertices[Q.currentPolygon.vertices.length-2]),Q.currentPolygon.vertices.length>2&&Q.addButton.removeAttribute("disabled"),g())}static moveCursor(e){if(null===Q.currentPolygon)throw new Error("Wystąpił błąd podczas dodawania wielokąta!");Q.currPoint=V(e),g(),l(Q.currPoint,5,r.Red),Q.prevPoint&&d(Q.prevPoint,Q.currPoint,r.Red),Q.currentPolygon.vertices.length&&d(Q.currentPolygon.vertices[0].position,Q.currPoint,r.Red),Q.currentPolygon.vertices.length>2&&m(Q.currPoint,Q.currentPolygon.vertices[0].position)<=15&&l(Q.currentPolygon.vertices[0].position,15,r.Red)}static clear(){Q.polygons=[],Q.polygonsInterator=0,Q.currentPolygon=null,Q.relationIterator=0,Q.prevPoint=null,Q.currPoint=null,Q.polygonsDiv.innerHTML="",g()}}Q.polygons=[],Q.currentPolygon=null,Q.polygonsInterator=0,Q.mode=f.Default,Q.prevPoint=null,Q.currPoint=null,Q.relationIterator=0,Q.thickness=1,Q.canvas=document.getElementById("canvas"),Q.context=Q.canvas.getContext("2d"),Q.hCanvas=document.getElementById("hidden-canvas"),Q.hContext=Q.hCanvas.getContext("2d"),Q.addButton=document.getElementById("button-add"),Q.clearButton=document.getElementById("button-clear"),Q.polygonsDiv=document.getElementById("div-polygons"),Q.init()}]);